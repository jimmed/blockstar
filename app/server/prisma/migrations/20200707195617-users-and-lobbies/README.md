# Migration `20200707195617-users-and-lobbies`

This migration has been generated by Jim O'Brien at 7/7/2020, 7:56:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."User" (
"avatar" TEXT NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"discriminator" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"ipv4" TEXT   ,"ipv6" TEXT   ,"updatedat" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"username" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE TABLE "quaint"."Lobby" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"ownerId" TEXT NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    PRIMARY KEY ("id"),FOREIGN KEY ("ownerId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_lobbyUser" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Lobby"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE UNIQUE INDEX "quaint"."_lobbyUser_AB_unique" ON "_lobbyUser"("A","B")

CREATE  INDEX "quaint"."_lobbyUser_B_index" ON "_lobbyUser"("B")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200707195617-users-and-lobbies
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,33 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+datasource sqlite {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id            String   @id
+  username      String
+  discriminator String
+  avatar        String
+  ipv4          String?
+  ipv6          String?
+  joinedLobbies Lobby[]  @relation(name: "lobbyUser", references: [id])
+  ownedLobbies  Lobby[]  @relation(name: "lobbyOwner")
+  createdAt     DateTime @default(now())
+  updatedat     DateTime @default(now())
+}
+
+model Lobby {
+  id        String   @default(uuid()) @id
+  name      String
+  ownerId   String
+  owner     User     @relation(name: "lobbyOwner", fields: [ownerId], references: [id])
+  users     User[]   @relation(name: "lobbyUser", references: [id])
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+}
```
